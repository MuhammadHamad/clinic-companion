import { Patient, Appointment, Invoice, InventoryItem, TreatmentType, InventoryCategory, Payment } from '@/types';

// Helper to generate dates
const today = new Date();
const formatDate = (date: Date) => date.toISOString().split('T')[0];
const daysAgo = (days: number) => {
  const d = new Date(today);
  d.setDate(d.getDate() - days);
  return formatDate(d);
};
const daysFromNow = (days: number) => {
  const d = new Date(today);
  d.setDate(d.getDate() + days);
  return formatDate(d);
};

export const mockPatients: Patient[] = [
  {
    id: '1',
    patient_number: 'P-001',
    first_name: 'Muhammad',
    last_name: 'Ali',
    date_of_birth: '1985-03-15',
    gender: 'male',
    phone: '0321-1234567',
    email: 'muhammad.ali@email.com',
    address: '123 Main Street, Block F',
    city: 'Lahore',
    emergency_contact_name: 'Fatima Ali',
    emergency_contact_phone: '0321-7654321',
    allergies: 'Penicillin',
    registration_date: daysAgo(180),
    last_visit_date: daysAgo(7),
    status: 'active',
    created_at: daysAgo(180),
    balance: 5000,
  },
  {
    id: '2',
    patient_number: 'P-002',
    first_name: 'Ayesha',
    last_name: 'Khan',
    date_of_birth: '1992-07-22',
    gender: 'female',
    phone: '0333-9876543',
    email: 'ayesha.khan@email.com',
    address: '45 Garden Town',
    city: 'Karachi',
    registration_date: daysAgo(90),
    last_visit_date: daysAgo(2),
    status: 'active',
    created_at: daysAgo(90),
    balance: 0,
  },
  {
    id: '3',
    patient_number: 'P-003',
    first_name: 'Ahmed',
    last_name: 'Raza',
    date_of_birth: '1978-11-08',
    gender: 'male',
    phone: '0300-1112233',
    email: 'ahmed.raza@email.com',
    address: '78 Model Town',
    city: 'Islamabad',
    medical_conditions: 'Diabetes',
    current_medications: 'Metformin',
    registration_date: daysAgo(365),
    last_visit_date: daysAgo(30),
    status: 'active',
    created_at: daysAgo(365),
    balance: 15000,
  },
  {
    id: '4',
    patient_number: 'P-004',
    first_name: 'Sara',
    last_name: 'Malik',
    date_of_birth: '1995-04-30',
    gender: 'female',
    phone: '0345-5556666',
    city: 'Lahore',
    registration_date: daysAgo(45),
    last_visit_date: daysAgo(14),
    status: 'active',
    created_at: daysAgo(45),
    balance: 3500,
  },
  {
    id: '5',
    patient_number: 'P-005',
    first_name: 'Hassan',
    last_name: 'Sheikh',
    date_of_birth: '1988-09-12',
    gender: 'male',
    phone: '0311-4443322',
    city: 'Faisalabad',
    registration_date: daysAgo(200),
    last_visit_date: daysAgo(60),
    status: 'inactive',
    created_at: daysAgo(200),
    balance: 0,
  },
];

export const mockTreatmentTypes: TreatmentType[] = [
  { id: '1', name: 'Checkup', code: 'CHK', default_price: 1500, duration_minutes: 30, category: 'diagnostic', is_active: true },
  { id: '2', name: 'Cleaning', code: 'CLN', default_price: 2500, duration_minutes: 45, category: 'preventive', is_active: true },
  { id: '3', name: 'Filling', code: 'FIL', default_price: 3500, duration_minutes: 45, category: 'restorative', is_active: true },
  { id: '4', name: 'Root Canal', code: 'RCT', default_price: 15000, duration_minutes: 120, category: 'restorative', is_active: true },
  { id: '5', name: 'Extraction', code: 'EXT', default_price: 3000, duration_minutes: 30, category: 'surgical', is_active: true },
  { id: '6', name: 'Crown', code: 'CRN', default_price: 25000, duration_minutes: 60, category: 'restorative', is_active: true },
  { id: '7', name: 'Teeth Whitening', code: 'WHT', default_price: 8000, duration_minutes: 60, category: 'cosmetic', is_active: true },
  { id: '8', name: 'X-Ray', code: 'XRY', default_price: 1000, duration_minutes: 15, category: 'diagnostic', is_active: true },
];

export const mockAppointments: Appointment[] = [
  {
    id: '1',
    patient_id: '1',
    dentist_id: '2',
    appointment_date: formatDate(today),
    start_time: '09:00',
    end_time: '09:30',
    appointment_type: 'Checkup',
    status: 'scheduled',
    reason_for_visit: 'Regular checkup',
    created_at: daysAgo(3),
    patient: mockPatients[0],
  },
  {
    id: '2',
    patient_id: '2',
    dentist_id: '2',
    appointment_date: formatDate(today),
    start_time: '10:00',
    end_time: '10:45',
    appointment_type: 'Cleaning',
    status: 'confirmed',
    created_at: daysAgo(2),
    patient: mockPatients[1],
  },
  {
    id: '3',
    patient_id: '3',
    dentist_id: '2',
    appointment_date: formatDate(today),
    start_time: '11:00',
    end_time: '12:30',
    appointment_type: 'Root Canal',
    status: 'scheduled',
    reason_for_visit: 'Tooth pain - upper right molar',
    created_at: daysAgo(5),
    patient: mockPatients[2],
  },
  {
    id: '4',
    patient_id: '4',
    dentist_id: '2',
    appointment_date: formatDate(today),
    start_time: '14:00',
    end_time: '14:45',
    appointment_type: 'Filling',
    status: 'completed',
    created_at: daysAgo(7),
    patient: mockPatients[3],
  },
  {
    id: '5',
    patient_id: '1',
    dentist_id: '2',
    appointment_date: daysFromNow(1),
    start_time: '09:30',
    end_time: '10:00',
    appointment_type: 'Checkup',
    status: 'scheduled',
    created_at: daysAgo(1),
    patient: mockPatients[0],
  },
  {
    id: '6',
    patient_id: '2',
    dentist_id: '2',
    appointment_date: daysAgo(1),
    start_time: '15:00',
    end_time: '16:00',
    appointment_type: 'Crown',
    status: 'completed',
    created_at: daysAgo(10),
    patient: mockPatients[1],
  },
];

export const mockInvoices: Invoice[] = [
  {
    id: '1',
    invoice_number: 'INV-001',
    patient_id: '1',
    invoice_date: daysAgo(7),
    due_date: daysFromNow(7),
    subtotal: 5000,
    discount_amount: 0,
    tax_amount: 0,
    total_amount: 5000,
    amount_paid: 0,
    balance: 5000,
    status: 'unpaid',
    created_at: daysAgo(7),
    patient: mockPatients[0],
    items: [
      { id: '1', invoice_id: '1', description: 'Root Canal - Molar', tooth_number: '16', quantity: 1, unit_price: 5000, total: 5000 },
    ],
  },
  {
    id: '2',
    invoice_number: 'INV-002',
    patient_id: '2',
    invoice_date: daysAgo(2),
    subtotal: 28500,
    discount_amount: 1000,
    tax_amount: 0,
    total_amount: 27500,
    amount_paid: 27500,
    balance: 0,
    status: 'paid',
    created_at: daysAgo(2),
    patient: mockPatients[1],
    items: [
      { id: '2', invoice_id: '2', description: 'Crown - Ceramic', tooth_number: '14', quantity: 1, unit_price: 25000, total: 25000 },
      { id: '3', invoice_id: '2', description: 'Cleaning', quantity: 1, unit_price: 2500, total: 2500 },
      { id: '4', invoice_id: '2', description: 'X-Ray', quantity: 1, unit_price: 1000, total: 1000 },
    ],
  },
  {
    id: '3',
    invoice_number: 'INV-003',
    patient_id: '3',
    invoice_date: daysAgo(30),
    due_date: daysAgo(16),
    subtotal: 15000,
    discount_amount: 0,
    tax_amount: 0,
    total_amount: 15000,
    amount_paid: 0,
    balance: 15000,
    status: 'overdue',
    created_at: daysAgo(30),
    patient: mockPatients[2],
    items: [
      { id: '5', invoice_id: '3', description: 'Root Canal Treatment', tooth_number: '26', quantity: 1, unit_price: 15000, total: 15000 },
    ],
  },
  {
    id: '4',
    invoice_number: 'INV-004',
    patient_id: '4',
    invoice_date: daysAgo(14),
    subtotal: 7000,
    discount_amount: 0,
    tax_amount: 0,
    total_amount: 7000,
    amount_paid: 3500,
    balance: 3500,
    status: 'partial',
    created_at: daysAgo(14),
    patient: mockPatients[3],
    items: [
      { id: '6', invoice_id: '4', description: 'Filling - Composite', tooth_number: '36', quantity: 2, unit_price: 3500, total: 7000 },
    ],
  },
];

export const mockPayments: Payment[] = [
  {
    id: '1',
    invoice_id: '2',
    patient_id: '2',
    payment_date: daysAgo(2),
    amount: 27500,
    payment_method: 'card',
    reference_number: 'TXN-001234',
    created_at: daysAgo(2),
  },
  {
    id: '2',
    invoice_id: '4',
    patient_id: '4',
    payment_date: daysAgo(14),
    amount: 3500,
    payment_method: 'cash',
    created_at: daysAgo(14),
  },
];

export const mockInventoryCategories: InventoryCategory[] = [
  { id: '1', name: 'Dental Materials', description: 'Composite, amalgam, cements' },
  { id: '2', name: 'Medicines', description: 'Antibiotics, painkillers, anesthetics' },
  { id: '3', name: 'Consumables', description: 'Gloves, masks, cotton, gauze' },
  { id: '4', name: 'Equipment', description: 'Instruments, tools' },
];

export const mockInventoryItems: InventoryItem[] = [
  {
    id: '1',
    category_id: '1',
    item_name: 'Composite Resin (A2 Shade)',
    item_code: 'ITM-001',
    unit_of_measure: 'syringe',
    current_quantity: 15,
    minimum_threshold: 10,
    unit_cost: 2500,
    supplier_name: 'Dental Supplies Pakistan',
    supplier_contact: '0321-5555555',
    status: 'in_stock',
    created_at: daysAgo(90),
    category: mockInventoryCategories[0],
  },
  {
    id: '2',
    category_id: '2',
    item_name: 'Lidocaine 2% with Epinephrine',
    item_code: 'ITM-002',
    unit_of_measure: 'box',
    current_quantity: 3,
    minimum_threshold: 5,
    unit_cost: 1800,
    supplier_name: 'MedPharma Ltd',
    expiry_date: daysFromNow(180),
    status: 'low_stock',
    created_at: daysAgo(60),
    category: mockInventoryCategories[1],
  },
  {
    id: '3',
    category_id: '3',
    item_name: 'Nitrile Gloves (Medium)',
    item_code: 'ITM-003',
    unit_of_measure: 'box',
    current_quantity: 0,
    minimum_threshold: 10,
    unit_cost: 650,
    supplier_name: 'SafetyFirst Supplies',
    status: 'out_of_stock',
    created_at: daysAgo(30),
    category: mockInventoryCategories[2],
  },
  {
    id: '4',
    category_id: '3',
    item_name: 'Surgical Masks (50-pack)',
    item_code: 'ITM-004',
    unit_of_measure: 'pack',
    current_quantity: 25,
    minimum_threshold: 15,
    unit_cost: 400,
    status: 'in_stock',
    created_at: daysAgo(45),
    category: mockInventoryCategories[2],
  },
  {
    id: '5',
    category_id: '2',
    item_name: 'Amoxicillin 500mg',
    item_code: 'ITM-005',
    unit_of_measure: 'strip',
    current_quantity: 50,
    minimum_threshold: 20,
    unit_cost: 150,
    expiry_date: daysFromNow(365),
    status: 'in_stock',
    created_at: daysAgo(20),
    category: mockInventoryCategories[1],
  },
  {
    id: '6',
    category_id: '1',
    item_name: 'Glass Ionomer Cement',
    item_code: 'ITM-006',
    unit_of_measure: 'kit',
    current_quantity: 4,
    minimum_threshold: 3,
    unit_cost: 3500,
    status: 'in_stock',
    created_at: daysAgo(120),
    category: mockInventoryCategories[0],
  },
];

// Dashboard stats helper
export const getDashboardStats = () => {
  const todayStr = formatDate(today);
  const todayAppointments = mockAppointments.filter(a => a.appointment_date === todayStr);
  
  return {
    today: {
      revenue: 31000,
      appointments_scheduled: todayAppointments.filter(a => a.status === 'scheduled' || a.status === 'confirmed').length,
      appointments_completed: todayAppointments.filter(a => a.status === 'completed').length,
      new_patients: 1,
    },
    month: {
      revenue: 245000,
      outstanding: mockInvoices.filter(i => i.status !== 'paid').reduce((sum, i) => sum + i.balance, 0),
      total_treatments: 47,
    },
    alerts: {
      low_stock_count: mockInventoryItems.filter(i => i.status === 'low_stock' || i.status === 'out_of_stock').length,
      overdue_invoices_count: mockInvoices.filter(i => i.status === 'overdue').length,
    },
  };
};

// Revenue chart data
export const getRevenueChartData = () => {
  return [
    { day: 'Mon', revenue: 35000 },
    { day: 'Tue', revenue: 42000 },
    { day: 'Wed', revenue: 28000 },
    { day: 'Thu', revenue: 51000 },
    { day: 'Fri', revenue: 38000 },
    { day: 'Sat', revenue: 45000 },
    { day: 'Sun', revenue: 6000 },
  ];
};
